version: '3.3'

services:
  steamcmd:
    image: my-steamcmd:${STEAMCMD_TAG:-latest}
    build:
      context: ./steamcmd
  insurgency-base:
    image: insurgency-base:${INSURGENCY_BASE_TAG:-latest}
    build:
      context: ./base
      args:
        APPID: 237410
        APPNAME: insurgency
        STEAMCMD_TAG: testing
  insurgency:
    image: insurgency:${INSURGENCY_TAG:-latest}
    build: ./insurgency
      args:
        INSURGENCY_BASE_TAG: testing
    environment:
      APP_SERVER_NAME: 'testname'
      APP_SERVER_PASSWORD: 'testpassword'
      APP_SERVER_RCONPASSWORD: 'testrcon'
      APP_SERVER_PORT: '27018'
      APP_SERVER_MAXPLAYERS: '32'
      APP_SERVER_MAP: 'market_coop'
    volumes:
      - ./insurgency/cfg:/tmp/insurgency
    ports:
      - "27018:27018"
      - "27018:27018/udp"
